<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Voxlblade Build Calculator</title>
  <style>
    body {
      font-family: Arial;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
    }
    h1 { color: #38bdf8; }
    select, button {
      width: 100%;
      padding: 10px;
      margin: 6px 0;
      font-size: 16px;
    }
    .box {
      background: #020617;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>Voxlblade Build Calculator</h1>

<div class="box">
  <label for="blade">Blade</label>
  <select id="blade">
    <option value="none">None</option>
    <!-- As Blades serão adicionadas aqui futuramente -->
  </select>

  <label for="weapon">Weapon / Handle</label>
  <select id="weapon"></select>

  <label for="race">Race</label>
  <select id="race"></select>

  <label for="perk1">Perk 1</label>
  <select id="perk1"></select>

  <label for="perk2">Perk 2</label>
  <select id="perk2"></select>

  <button onclick="calculate()">Calculate Build</button>

  <div id="result"></div>
</div>

<script>
// ======= RAÇAS =======
const races = [
  { name: "Human", value: "human", bonuses: { damageBoostUnder50HP: 0.20 }, special: "Bônus de dano e redução de dano quando HP < 50%" },
  { name: "High Elf", value: "highelf", bonuses: { attackSpeed: 0.10 }, special: "Weapon Arts mais rápidos" },
  { name: "Kitsune", value: "kitsune", bonuses: { attackSpeed: 0.10, moveSpeed: 0.10 }, special: "Mais rápido e ágil" },
  { name: "Half-Ork", value: "halfork", bonuses: { armorPen: 10 }, special: "Bônus de penetração de armadura" },
  { name: "Dark Elf", value: "darkelf", bonuses: { debuffChance: 0.08 }, special: "Chance de aplicar debuff aleatório" },
  { name: "Dragon-Blooded", value: "dragonblooded", bonuses: { warding: 0.50, protection: 10 }, special: "Alta resistência e proteção" },
  { name: "Ork", value: "ork", bonuses: { armorPenWeaponArts: 10, tenacity: 0.2 }, special: "Bônus em Weapon Arts e Tenacity" },
  { name: "Elf", value: "elf", bonuses: { runeCooldownReduction: 0.40 }, special: "Redução de cooldown das Runes" },
  { name: "Arborian", value: "arborian", bonuses: { fireDefReduction: 0.50, protection: 15 }, special: "Proteção e regeneração" },
  { name: "Bunikin", value: "bunikin", bonuses: { jumpBonus: 5, dodgeCrit: true }, special: "Esquiva garante crítico" }
];

// ======= BLADES (por enquanto só None) =======
const blades = [
  { name: "None", value: "none", baseDamage: 0, attackSpeed: 0, critChance: 0, critDamage: 1.0, armorPen: 0 }
  // Aqui você adicionará futuramente todas as Blades com stats base
];

// ======= ARMAS / HANDLES =======
const weapons = [
  {
    name: "Gilded Pole",
    value: "gildedpole",
    baseDamage: 12,
    attackSpeed: 1.0,
    critChance: 0.05,
    critDamage: 1.5,
    armorPen: 5
  },
  {
    name: "Reinforced Pole",
    value: "reinforcedpole",
    baseDamage: 11,
    attackSpeed: 1.0,
    critChance: 0.05,
    critDamage: 1.5,
    armorPen: 6
  }
  // Futuramente adicionar todas as armas oficiais
];

// ======= PERKS =======
const perks = [
  { name: "Nenhum", type: "none", value: 0, description: "Nenhum bônus aplicado" },
  { name: "Sharpshooter", type: "critChance", value: 0.05, description: "Aumenta 5% de chance de crítico" },
  { name: "Berserker", type: "damage", value: 0.10, description: "Aumenta 10% de dano total" },
  { name: "Swift Footed", type: "attackSpeed", value: 0.10, description: "Aumenta 10% de velocidade de ataque" },
  { name: "Fortified", type: "protection", value: 5, description: "Aumenta 5 pontos de proteção" },
  { name: "Armor Breaker", type: "armorPen", value: 5, description: "Aumenta penetração de armadura em 5" },
  { name: "Elementalist", type: "elementalDamage", value: 0.15, description: "Aumenta 15% de dano elemental" },
  { name: "Critical Mastery", type: "critDamage", value: 0.25, description: "Aumenta 25% de dano crítico" }
];

// ======= POPULAR DROPDOWNS =======
function populateSelect(select, array) {
  array.forEach(item => {
    const option = document.createElement("option");
    option.value = item.value;
    option.text = item.name;
    option.title = item.description || item.special || "";
    select.add(option);
  });
}

populateSelect(document.getElementById("race"), races);
populateSelect(document.getElementById("blade"), blades);
populateSelect(document.getElementById("weapon"), weapons);
populateSelect(document.getElementById("perk1"), perks);
populateSelect(document.getElementById("perk2"), perks);

// Evitar perks duplicados
const perk1Select = document.getElementById("perk1");
const perk2Select = document.getElementById("perk2");
function updatePerkOptions() {
  const perk1Value = perk1Select.value;
  const perk2Value = perk2Select.value;
  [...perk1Select.options].forEach(option => option.disabled = option.value === perk2Value && option.value !== "Nenhum");
  [...perk2Select.options].forEach(option => option.disabled = option.value === perk1Value && option.value !== "Nenhum");
}
perk1Select.addEventListener("change", updatePerkOptions);
perk2Select.addEventListener("change", updatePerkOptions);
updatePerkOptions();

// ======= CÁLCULO DE DPS =======
const playerMaxHP = 100;
let playerHP = 100;

function calculate() {
  const bladeValue = document.getElementById("blade").value;
  const weaponValue = document.getElementById("weapon").value;
  const raceValue = document.getElementById("race").value;
  const perk1Value = perk1Select.value;
  const perk2Value = perk2Select.value;

  const selectedBlade = blades.find(b => b.value === bladeValue);
  const selectedWeapon = weapons.find(w => w.value === weaponValue);
  const selectedRace = races.find(r => r.value === raceValue);
  const selectedPerk1 = perks.find(p => p.name === perk1Value);
  const selectedPerk2 = perks.find(p => p.name === perk2Value);

  // Stats base combinados: Blade + Weapon
  let dmg = selectedWeapon.baseDamage + selectedBlade.baseDamage;
  let speed = selectedWeapon.attackSpeed + selectedBlade.attackSpeed;
  let critChance = selectedWeapon.critChance + selectedBlade.critChance;
  let critDamage = selectedWeapon.critDamage * selectedBlade.critDamage;
  let armorPen = selectedWeapon.armorPen + selectedBlade.armorPen;
  let protection = 0;

  // Bônus de raça
  if(selectedRace.value === "human" && playerHP < 0.5 * playerMaxHP) {
    dmg *= 1 + (selectedRace.bonuses.damageBoostUnder50HP || 0);
  }
  if(selectedRace.bonuses.attackSpeed) speed *= 1 + selectedRace.bonuses.attackSpeed;
  if(selectedRace.bonuses.armorPenWeaponArts) armorPen += selectedRace.bonuses.armorPenWeaponArts;

  // Aplicar perks
  [selectedPerk1, selectedPerk2].forEach(p => {
    if(!p || p.type === "none") return;
    switch(p.type){
      case "damage": dmg *= 1 + p.value; break;
      case "attackSpeed": speed *= 1 + p.value; break;
      case "critChance": critChance += p.value; break;
      case "critDamage": critDamage += p.value; break;
      case "armorPen": armorPen += p.value; break;
      case "protection": protection += p.value; break;
    }
  });

  const dps = dmg * speed * (1 + critChance * (critDamage - 1));

  document.getElementById("result").innerHTML =
    `<h3>DPS Final</h3>
     <p><strong>${dps.toFixed(2)}</strong></p>
     <p>Raça: ${selectedRace.name}</p>
     <p>Blade: ${selectedBlade.name}</p>
     <p>Weapon / Handle: ${selectedWeapon.name}</p>
     <p>Perk 1: ${selectedPerk1 ? selectedPerk1.name : "Nenhum"}</p>
     <p>Perk 2: ${selectedPerk2 ? selectedPerk2.name : "Nenhum"}</p>
     <p>Proteção total: ${protection}</p>
     <p>Penetração de armadura: ${armorPen}</p>
     <p>Especial da raça: ${selectedRace.special}</p>`;
}
</script>

</body>
</html>
