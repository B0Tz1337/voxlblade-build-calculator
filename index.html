<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Voxlblade Build Calculator</title>
  <style>
    body {
      font-family: Arial;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
    }
    h1 { color: #38bdf8; }
    select, button {
      width: 100%;
      padding: 10px;
      margin: 6px 0;
      font-size: 16px;
    }
    .box {
      background: #020617;
      padding: 15px;
      border-radius: 8px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>Voxlblade Build Calculator</h1>

<div class="box">
  <label for="blade">Blade</label>
  <select id="blade">
    <option value="none">None</option>
    <!-- As Blades serão adicionadas aqui futuramente -->
  </select>

  <label for="Handle">Handle</label>
  <select id="Handle"></select>

  <label for="race">Race</label>
  <select id="race"></select>

  <button onclick="calculate()">Calculate Build</button>

  <div id="result"></div>
</div>

<script>
// ======= RAÇAS =======
const races = [
  { name: "Human", value: "human", bonuses: { damageBoostUnder50HP: 0.20 }, special: "Bônus de dano e redução de dano quando HP < 50%" },
  { name: "High Elf", value: "highelf", bonuses: { attackSpeed: 0.10 }, special: "Weapon Arts mais rápidos" },
  { name: "Kitsune", value: "kitsune", bonuses: { attackSpeed: 0.10, moveSpeed: 0.10 }, special: "Mais rápido e ágil" },
  { name: "Half-Ork", value: "halfork", bonuses: { armorPen: 10 }, special: "Bônus de penetração de armadura" },
  { name: "Dark Elf", value: "darkelf", bonuses: { debuffChance: 0.08 }, special: "Chance de aplicar debuff aleatório" },
  { name: "Dragon-Blooded", value: "dragonblooded", bonuses: { warding: 0.50, protection: 10 }, special: "Alta resistência e proteção" },
  { name: "Ork", value: "ork", bonuses: { armorPenWeaponArts: 10, tenacity: 0.2 }, special: "Bônus em Weapon Arts e Tenacity" },
  { name: "Elf", value: "elf", bonuses: { runeCooldownReduction: 0.40 }, special: "Redução de cooldown das Runes" },
  { name: "Arborian", value: "arborian", bonuses: { fireDefReduction: 0.50, protection: 15 }, special: "Proteção e regeneração" },
  { name: "Bunikin", value: "bunikin", bonuses: { jumpBonus: 5, dodgeCrit: true }, special: "Esquiva garante crítico" }
];

// ======= BLADES (por enquanto só None) =======
const blades = [
  { name: "None", value: "none", baseDamage: 0, attackSpeed: 0, critChance: 0, critDamage: 1.0, armorPen: 0, perks: [] }
  // Futuramente adicionar todas as Blades com stats base + perks passivos
];

// ======= ARMAS / HANDLES =======
const weapons = [
  {
    name: "Gilded Pole",
    value: "gildedpole",
    baseDamage: 12,
    attackSpeed: 1.0,
    critChance: 0.05,
    critDamage: 1.5,
    armorPen: 5,
    perks: [] // perks passivos da arma, se houver
  },
  {
    name: "Reinforced Pole",
    value: "reinforcedpole",
    baseDamage: 11,
    attackSpeed: 1.0,
    critChance: 0.05,
    critDamage: 1.5,
    armorPen: 6,
    perks: []
  }
  // Futuramente adicionar todas as armas oficiais com perks passivos
];

// ======= POPULAR DROPDOWNS =======
function populateSelect(select, array) {
  array.forEach(item => {
    const option = document.createElement("option");
    option.value = item.value;
    option.text = item.name;
    select.add(option);
  });
}

populateSelect(document.getElementById("race"), races);
populateSelect(document.getElementById("blade"), blades);
populateSelect(document.getElementById("weapon"), weapons);

// ======= CÁLCULO DE DPS =======
const playerMaxHP = 100;
let playerHP = 100;

function calculate() {
  const bladeValue = document.getElementById("blade").value;
  const weaponValue = document.getElementById("weapon").value;
  const raceValue = document.getElementById("race").value;

  const selectedBlade = blades.find(b => b.value === bladeValue);
  const selectedWeapon = weapons.find(w => w.value === weaponValue);
  const selectedRace = races.find(r => r.value === raceValue);

  // Stats base combinados: Blade + Weapon
  let dmg = selectedWeapon.baseDamage + selectedBlade.baseDamage;
  let speed = selectedWeapon.attackSpeed + selectedBlade.attackSpeed;
  let critChance = selectedWeapon.critChance + selectedBlade.critChance;
  let critDamage = selectedWeapon.critDamage * selectedBlade.critDamage;
  let armorPen = selectedWeapon.armorPen + selectedBlade.armorPen;
  let protection = 0;

  // Aplicar perks passivos (Blade + Weapon)
  [...(selectedBlade.perks || []), ...(selectedWeapon.perks || [])].forEach(p => {
    switch(p.type){
      case "damage": dmg *= 1 + p.value; break;
      case "attackSpeed": speed *= 1 + p.value; break;
      case "critChance": critChance += p.value; break;
      case "critDamage": critDamage += p.value; break;
      case "armorPen": armorPen += p.value; break;
      case "protection": protection += p.value; break;
    }
  });

  // Bônus de raça
  if(selectedRace.value === "human" && playerHP < 0.5 * playerMaxHP) {
    dmg *= 1 + (selectedRace.bonuses.damageBoostUnder50HP || 0);
  }
  if(selectedRace.bonuses.attackSpeed) speed *= 1 + selectedRace.bonuses.attackSpeed;
  if(selectedRace.bonuses.armorPenWeaponArts) armorPen += selectedRace.bonuses.armorPenWeaponArts;

  const dps = dmg * speed * (1 + critChance * (critDamage - 1));

  document.getElementById("result").innerHTML =
    `<h3>DPS Final</h3>
     <p><strong>${dps.toFixed(2)}</strong></p>
     <p>Raça: ${selectedRace.name}</p>
     <p>Blade: ${selectedBlade.name}</p>
     <p>Weapon / Handle: ${selectedWeapon.name}</p>
     <p>Proteção total: ${protection}</p>
     <p>Penetração de armadura: ${armorPen}</p>
     <p>Especial da raça: ${selectedRace.special}</p>`;
}
</script>

</body>
</html>
